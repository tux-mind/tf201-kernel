
This file aims to explain how to compile the kernel with the sources in this repository.

This is not a faithful documentation yet,
but rather a return on experiment of a successful cross-compilation with Ubuntu 16.04 in may 2020.


# Compilation directly on the target

Please read through the [Asus_Transformer_Prime](https://wiki.gentoo.org/wiki/Asus_Transformer_Prime) page on the gentoo Wiki.

Not tested on my own (@Alexis-ROYER, may 2020).


# Cross compilation

Return on experiment on a successful build with Ubuntu 16.04, in may 2020.

## Tools

This version of the kernel sources does not support gcc version 5.x.
Install a cross-compiler up to gcc v4.9 max, for instance:
```bash
sudo apt install gcc-4.9-arm-linux-gnueabihf
```
> Note: Use of the *hf* version (`gnueabihf`, not `gnueabi`).
> This choice being inspired by the [lifeinarootshell HOWTO](http://lifeinarootshell.blogspot.it/2013/03/howto.html) post,
> and especially the download link for the Ubuntu distro: http://cdimage.ubuntu.com/releases/12.04/release/ubuntu-12.04-preinstalled-desktop-armhf+ac100.tar.gz

Then, as suggested by https://wiki.gentoo.org/wiki/Embedded_Handbook/General/Cross-compiling_the_kernel,
creation of the `xkmake` script that launches the compilation with the cross-compiler installed just before.
Please ensure the `CROSS_COMPILE` variable is set to the appropriate value depending on what you installed.

> Note: Due to perl deprecations, the `kernel/timeconst.pl` had to be fixed.
> As of may 2020, works with perl v5.22.1.

## Compilation

```bash
./xkmake
```

The output `zImage` is in `arch/arm/boot`.

